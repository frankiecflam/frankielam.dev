import { ImageResponse } from "@vercel/og";
import { NextRequest } from "next/server";

export const config = {
  runtime: "edge",
};

export default function handler(req: NextRequest) {
  try {
    const { searchParams } = new URL(req.url);

    // ?title=<title>
    const hasTitle = searchParams.has("title");
    const hasDescription = searchParams.has("description");
    const title = hasTitle
      ? searchParams.get("title")?.slice(0, 100)
      : "My default title";
    const description = hasDescription
      ? searchParams.get("description")?.slice(0, 50)
      : "My default description";

    return new ImageResponse(
      (
        <div
          style={{
            backgroundColor: "black",
            backgroundSize: "150px 150px",
            height: "100%",
            width: "100%",
            display: "flex",
            textAlign: "center",
            alignItems: "center",
            justifyContent: "center",
            flexDirection: "column",
            flexWrap: "nowrap",
          }}
        >
          <div
            style={{
              display: "flex",
              alignItems: "center",
              justifyContent: "center",
              flexDirection: "column",
            }}
          >
            <svg
              version="1.1"
              id="Layer_1"
              xmlns="http://www.w3.org/2000/svg"
              xmlnsXlink="http://www.w3.org/1999/xlink"
              x="0px"
              y="0px"
              width="100%"
              viewBox="0 0 1080 1080"
              enable-background="new 0 0 1080 1080"
              xmlSpace="preserve"
              style={{
                width: "350px",
                height: "350px",
                objectFit: "cover",
              }}
            >
              <path
                fill="#000000"
                opacity="0"
                stroke="none"
                d="
M630.000000,1081.000000 
	C420.024170,1081.000000 210.548355,1081.000000 1.036263,1081.000000 
	C1.036263,721.065735 1.036263,361.131439 1.036263,1.098576 
	C360.892731,1.098576 720.785461,1.098576 1080.839111,1.098576 
	C1080.839111,360.999939 1080.839111,720.999939 1080.839111,1081.000000 
	C930.797607,1081.000000 780.648804,1081.000000 630.000000,1081.000000 
M431.013275,953.484375 
	C449.343933,958.176819 467.744843,962.489624 486.675110,964.025574 
	C502.662415,965.322693 518.629822,966.959900 534.639160,967.848816 
	C542.343262,968.276611 550.128845,967.412659 557.868774,966.978638 
	C568.200500,966.399231 578.560303,966.011963 588.841064,964.914062 
	C600.932312,963.622986 613.124268,962.438477 624.964966,959.817810 
	C646.844360,954.975342 668.537537,949.422913 689.558655,941.282715 
	C717.275879,930.549438 744.042053,918.101990 769.092468,902.033325 
	C792.228333,887.192749 813.890198,870.453003 833.840881,851.575623 
	C842.253418,843.615662 850.150696,835.081299 857.924988,826.485046 
	C866.027405,817.526184 874.404358,808.680969 881.394287,798.882263 
	C891.904785,784.148560 901.416321,768.694458 911.163635,753.426025 
	C924.696289,732.228333 934.186035,709.040100 942.838379,685.613892 
	C953.448120,656.888245 960.848938,627.223145 963.935181,596.664490 
	C965.646545,579.719727 966.894043,562.718262 967.880127,545.715088 
	C968.259338,539.176819 967.436829,532.555420 966.977966,525.984741 
	C966.053040,512.741089 965.587158,499.428864 963.849976,486.287933 
	C961.841003,471.091705 959.099548,455.957245 955.900696,440.961395 
	C950.660400,416.394989 942.242310,392.789368 931.881775,369.956177 
	C924.977173,354.739441 917.875427,339.495941 909.352966,325.161530 
	C900.556580,310.366455 890.464844,296.248840 879.960388,282.587952 
	C869.420837,268.881470 857.894043,255.906601 846.360840,243.003525 
	C840.652710,236.617401 834.019958,231.045532 827.690552,225.230423 
	C821.895813,219.906464 816.317871,214.242126 809.991394,209.622055 
	C794.620056,198.396881 779.400574,186.808319 763.127319,177.015686 
	C745.538452,166.431335 727.221741,156.830139 708.492798,148.426300 
	C687.034546,138.797806 664.457825,132.122299 641.494446,126.580772 
	C617.124084,120.699699 592.486694,116.731972 567.596680,115.284081 
	C548.762146,114.188438 529.748535,115.131569 510.869904,116.171349 
	C496.413239,116.967583 481.900208,118.561981 467.671265,121.199013 
	C450.769806,124.331314 433.991150,128.410263 417.436401,133.064667 
	C389.988708,140.781662 363.674133,151.498688 338.854309,165.649445 
	C328.222260,171.711182 317.210175,177.308685 307.333527,184.448822 
	C289.314453,197.475372 271.261078,210.641830 254.611145,225.325134 
	C235.785294,241.927338 218.213272,260.118805 203.383072,280.458740 
	C191.343826,296.970825 180.697037,314.513092 169.723404,331.783203 
	C157.683014,350.732147 148.839569,371.309631 141.160294,392.281281 
	C132.640869,415.547485 125.487701,439.299072 121.993408,463.953033 
	C119.551834,481.179565 115.925163,498.388245 115.329521,515.691040 
	C114.444122,541.411194 113.522041,567.293579 117.994232,592.900452 
	C121.051666,610.406738 123.245300,628.114929 127.316689,645.381165 
	C133.493088,671.574768 142.493027,696.950317 154.075638,721.279602 
	C164.117569,742.372681 175.754501,762.576111 188.908554,781.945862 
	C203.357071,803.221741 220.089142,822.555298 237.775452,841.084229 
	C245.261185,848.926636 253.654160,855.909912 261.713501,863.196594 
	C278.455261,878.333435 296.689423,891.427368 315.794189,903.441589 
	C342.061981,919.960449 369.931976,933.048279 399.079895,943.457153 
	C409.317932,947.113220 419.876190,949.872498 431.013275,953.484375 
z"
              />
              <path
                fill="#EDEDED"
                opacity="1.000000"
                stroke="none"
                d="
M430.650757,953.262817 
	C419.876190,949.872498 409.317932,947.113220 399.079895,943.457153 
	C369.931976,933.048279 342.061981,919.960449 315.794189,903.441589 
	C296.689423,891.427368 278.455261,878.333435 261.713501,863.196594 
	C253.654160,855.909912 245.261185,848.926636 237.775452,841.084229 
	C220.089142,822.555298 203.357071,803.221741 188.908554,781.945862 
	C175.754501,762.576111 164.117569,742.372681 154.075638,721.279602 
	C142.493027,696.950317 133.493088,671.574768 127.316689,645.381165 
	C123.245300,628.114929 121.051666,610.406738 117.994232,592.900452 
	C113.522041,567.293579 114.444122,541.411194 115.329521,515.691040 
	C115.925163,498.388245 119.551834,481.179565 121.993408,463.953033 
	C125.487701,439.299072 132.640869,415.547485 141.160294,392.281281 
	C148.839569,371.309631 157.683014,350.732147 169.723404,331.783203 
	C180.697037,314.513092 191.343826,296.970825 203.383072,280.458740 
	C218.213272,260.118805 235.785294,241.927338 254.611145,225.325134 
	C271.261078,210.641830 289.314453,197.475372 307.333527,184.448822 
	C317.210175,177.308685 328.222260,171.711182 338.854309,165.649445 
	C363.674133,151.498688 389.988708,140.781662 417.436401,133.064667 
	C433.991150,128.410263 450.769806,124.331314 467.671265,121.199013 
	C481.900208,118.561981 496.413239,116.967583 510.869904,116.171349 
	C529.748535,115.131569 548.762146,114.188438 567.596680,115.284081 
	C592.486694,116.731972 617.124084,120.699699 641.494446,126.580772 
	C664.457825,132.122299 687.034546,138.797806 708.492798,148.426300 
	C727.221741,156.830139 745.538452,166.431335 763.127319,177.015686 
	C779.400574,186.808319 794.620056,198.396881 809.991394,209.622055 
	C816.317871,214.242126 821.895813,219.906464 827.690552,225.230423 
	C834.019958,231.045532 840.652710,236.617401 846.360840,243.003525 
	C857.894043,255.906601 869.420837,268.881470 879.960388,282.587952 
	C890.464844,296.248840 900.556580,310.366455 909.352966,325.161530 
	C917.875427,339.495941 924.977173,354.739441 931.881775,369.956177 
	C942.242310,392.789368 950.660400,416.394989 955.900696,440.961395 
	C959.099548,455.957245 961.841003,471.091705 963.849976,486.287933 
	C965.587158,499.428864 966.053040,512.741089 966.977966,525.984741 
	C967.436829,532.555420 968.259338,539.176819 967.880127,545.715088 
	C966.894043,562.718262 965.646545,579.719727 963.935181,596.664490 
	C960.848938,627.223145 953.448120,656.888245 942.838379,685.613892 
	C934.186035,709.040100 924.696289,732.228333 911.163635,753.426025 
	C901.416321,768.694458 891.904785,784.148560 881.394287,798.882263 
	C874.404358,808.680969 866.027405,817.526184 857.924988,826.485046 
	C850.150696,835.081299 842.253418,843.615662 833.840881,851.575623 
	C813.890198,870.453003 792.228333,887.192749 769.092468,902.033325 
	C744.042053,918.101990 717.275879,930.549438 689.558655,941.282715 
	C668.537537,949.422913 646.844360,954.975342 624.964966,959.817810 
	C613.124268,962.438477 600.932312,963.622986 588.841064,964.914062 
	C578.560303,966.011963 568.200500,966.399231 557.868774,966.978638 
	C550.128845,967.412659 542.343262,968.276611 534.639160,967.848816 
	C518.629822,966.959900 502.662415,965.322693 486.675110,964.025574 
	C467.744843,962.489624 449.343933,958.176819 430.650757,953.262817 
M821.026672,266.543549 
	C816.201416,262.045380 811.423828,257.494751 806.538940,253.062256 
	C800.463623,247.549622 794.638000,241.684341 788.101501,236.774017 
	C775.721191,227.473709 763.445801,217.838898 750.151184,209.997253 
	C731.349548,198.907364 712.187134,188.119858 692.223511,179.387238 
	C666.896606,168.308609 640.439209,159.956543 612.874329,156.027710 
	C595.021851,153.483200 577.164673,150.057785 559.216980,149.338226 
	C539.118774,148.532471 518.845276,149.524170 498.782166,151.272629 
	C484.048157,152.556625 469.504425,156.186356 454.921326,159.005768 
	C426.420288,164.515945 399.338837,174.335144 373.364319,187.098740 
	C360.267670,193.534317 347.486084,200.679733 334.917236,208.105377 
	C314.100769,220.403656 294.889771,235.058838 277.244751,251.497314 
	C258.601624,268.865601 241.179977,287.438202 226.163834,308.219574 
	C210.015854,330.567291 195.793961,353.905975 184.374680,379.050873 
	C173.194153,403.669983 164.803146,429.061432 158.666214,455.403137 
	C153.481308,477.658356 150.259369,500.163605 149.315567,522.813721 
	C148.478241,542.908264 149.396744,563.204163 151.295700,583.244812 
	C152.874649,599.908203 156.596542,616.417053 160.099915,632.838440 
	C165.446609,657.900024 174.186432,681.896301 185.067932,705.057068 
	C195.552536,727.373169 207.324677,749.033936 222.323242,768.685547 
	C232.293427,781.748901 242.825104,794.404846 253.537277,806.872192 
	C259.183350,813.443420 265.540833,819.454529 271.957733,825.300781 
	C282.486145,834.892944 292.766418,844.893372 304.150085,853.382263 
	C326.870667,870.325073 350.886688,885.267334 376.814331,897.039001 
	C400.285278,907.695251 424.362854,916.233826 449.458710,922.342224 
	C471.942810,927.814758 494.664520,931.782349 517.633057,932.680847 
	C538.901184,933.512756 560.341003,932.482788 581.578613,930.734802 
	C597.488647,929.425293 613.260376,925.996399 628.982056,922.937500 
	C656.387817,917.605286 682.331421,907.847351 707.577698,896.074768 
	C728.685059,886.232178 748.989990,874.935791 767.478394,860.804138 
	C783.278320,848.727356 798.485596,835.839172 813.499268,822.785645 
	C820.584106,816.625854 826.850525,809.455078 833.038513,802.351135 
	C840.633728,793.631653 848.245178,784.851135 854.968018,775.465454 
	C863.881775,763.020752 872.188477,750.118896 880.312744,737.136047 
	C892.727051,717.297546 902.109741,695.973572 910.012512,673.987976 
	C916.983948,654.593262 923.075317,634.927429 926.153015,614.500977 
	C928.719910,597.464905 932.014709,580.396667 932.691467,563.252014 
	C933.627808,539.531555 933.750183,515.726990 930.175049,492.019653 
	C927.593750,474.902893 924.264343,458.043091 920.193359,441.217834 
	C914.147217,416.228699 904.658203,392.603760 893.695068,369.548798 
	C887.978760,357.527710 881.024109,346.058746 874.123169,334.646179 
	C863.464539,317.019379 851.320679,300.433655 837.563416,285.062469 
	C832.203735,279.074097 826.888977,273.045471 821.026672,266.543549 
z"
              />
              <path
                fill="#000000"
                opacity="0"
                stroke="none"
                d="
M821.290161,266.789368 
	C826.888977,273.045471 832.203735,279.074097 837.563416,285.062469 
	C851.320679,300.433655 863.464539,317.019379 874.123169,334.646179 
	C881.024109,346.058746 887.978760,357.527710 893.695068,369.548798 
	C904.658203,392.603760 914.147217,416.228699 920.193359,441.217834 
	C924.264343,458.043091 927.593750,474.902893 930.175049,492.019653 
	C933.750183,515.726990 933.627808,539.531555 932.691467,563.252014 
	C932.014709,580.396667 928.719910,597.464905 926.153015,614.500977 
	C923.075317,634.927429 916.983948,654.593262 910.012512,673.987976 
	C902.109741,695.973572 892.727051,717.297546 880.312744,737.136047 
	C872.188477,750.118896 863.881775,763.020752 854.968018,775.465454 
	C848.245178,784.851135 840.633728,793.631653 833.038513,802.351135 
	C826.850525,809.455078 820.584106,816.625854 813.499268,822.785645 
	C798.485596,835.839172 783.278320,848.727356 767.478394,860.804138 
	C748.989990,874.935791 728.685059,886.232178 707.577698,896.074768 
	C682.331421,907.847351 656.387817,917.605286 628.982056,922.937500 
	C613.260376,925.996399 597.488647,929.425293 581.578613,930.734802 
	C560.341003,932.482788 538.901184,933.512756 517.633057,932.680847 
	C494.664520,931.782349 471.942810,927.814758 449.458710,922.342224 
	C424.362854,916.233826 400.285278,907.695251 376.814331,897.039001 
	C350.886688,885.267334 326.870667,870.325073 304.150085,853.382263 
	C292.766418,844.893372 282.486145,834.892944 271.957733,825.300781 
	C265.540833,819.454529 259.183350,813.443420 253.537277,806.872192 
	C242.825104,794.404846 232.293427,781.748901 222.323242,768.685547 
	C207.324677,749.033936 195.552536,727.373169 185.067932,705.057068 
	C174.186432,681.896301 165.446609,657.900024 160.099915,632.838440 
	C156.596542,616.417053 152.874649,599.908203 151.295700,583.244812 
	C149.396744,563.204163 148.478241,542.908264 149.315567,522.813721 
	C150.259369,500.163605 153.481308,477.658356 158.666214,455.403137 
	C164.803146,429.061432 173.194153,403.669983 184.374680,379.050873 
	C195.793961,353.905975 210.015854,330.567291 226.163834,308.219574 
	C241.179977,287.438202 258.601624,268.865601 277.244751,251.497314 
	C294.889771,235.058838 314.100769,220.403656 334.917236,208.105377 
	C347.486084,200.679733 360.267670,193.534317 373.364319,187.098740 
	C399.338837,174.335144 426.420288,164.515945 454.921326,159.005768 
	C469.504425,156.186356 484.048157,152.556625 498.782166,151.272629 
	C518.845276,149.524170 539.118774,148.532471 559.216980,149.338226 
	C577.164673,150.057785 595.021851,153.483200 612.874329,156.027710 
	C640.439209,159.956543 666.896606,168.308609 692.223511,179.387238 
	C712.187134,188.119858 731.349548,198.907364 750.151184,209.997253 
	C763.445801,217.838898 775.721191,227.473709 788.101501,236.774017 
	C794.638000,241.684341 800.463623,247.549622 806.538940,253.062256 
	C811.423828,257.494751 816.201416,262.045380 821.290161,266.789368 
M396.557434,541.013977 
	C388.308197,582.537170 380.058960,624.060364 371.764343,665.812134 
	C382.874634,665.812134 393.322784,665.812134 403.776672,665.812134 
	C411.236755,628.488708 418.661072,591.344177 426.127533,553.988831 
	C454.571259,553.988831 482.687805,553.988831 510.763458,553.988831 
	C512.504578,544.404663 514.193787,535.106018 516.019958,525.053467 
	C487.469757,525.053467 459.804688,525.053467 431.971619,525.053467 
	C437.499084,496.954987 442.901917,469.490082 448.332458,441.884338 
	C484.040741,441.884338 519.324646,441.884338 554.711975,441.884338 
	C556.328918,432.897675 557.906738,424.128326 559.489563,415.331268 
	C512.609131,415.331268 466.880310,415.331268 421.184509,415.331268 
	C421.023987,416.974609 421.008118,418.310638 420.750366,419.598236 
	C417.519989,435.735535 414.260071,451.866913 410.996552,467.997528 
	C408.057098,482.526428 405.032074,497.038483 402.182098,511.584839 
	C400.315826,521.110352 398.694122,530.683899 396.557434,541.013977 
M625.986572,478.221161 
	C626.097046,476.578979 626.024353,474.900024 626.345825,473.300262 
	C630.223938,454.000732 634.160339,434.712891 638.128906,415.188782 
	C627.400940,415.188782 616.942993,415.188782 606.017700,415.188782 
	C589.542236,498.602173 573.055359,582.073547 556.629761,665.234558 
	C557.538635,665.794800 557.680481,665.958862 557.822388,665.958923 
	C604.819153,665.979919 651.815918,665.959412 698.812439,666.074402 
	C701.659302,666.081360 702.543640,664.806702 702.992676,662.516541 
	C703.240540,661.252258 703.481445,659.986450 703.711975,658.718933 
	C704.883423,652.278198 706.050598,645.836792 707.303589,638.930664 
	C669.073914,638.930664 631.629456,638.930664 593.642395,638.930664 
	C604.340637,585.322449 614.950134,532.158997 625.986572,478.221161 
z"
              />
              <path
                fill="#EDEDED"
                opacity="1.000000"
                stroke="none"
                d="
M396.760132,540.624939 
	C398.694122,530.683899 400.315826,521.110352 402.182098,511.584839 
	C405.032074,497.038483 408.057098,482.526428 410.996552,467.997528 
	C414.260071,451.866913 417.519989,435.735535 420.750366,419.598236 
	C421.008118,418.310638 421.023987,416.974609 421.184509,415.331268 
	C466.880310,415.331268 512.609131,415.331268 559.489563,415.331268 
	C557.906738,424.128326 556.328918,432.897675 554.711975,441.884338 
	C519.324646,441.884338 484.040741,441.884338 448.332458,441.884338 
	C442.901917,469.490082 437.499084,496.954987 431.971619,525.053467 
	C459.804688,525.053467 487.469757,525.053467 516.019958,525.053467 
	C514.193787,535.106018 512.504578,544.404663 510.763458,553.988831 
	C482.687805,553.988831 454.571259,553.988831 426.127533,553.988831 
	C418.661072,591.344177 411.236755,628.488708 403.776672,665.812134 
	C393.322784,665.812134 382.874634,665.812134 371.764343,665.812134 
	C380.058960,624.060364 388.308197,582.537170 396.760132,540.624939 
z"
              />
              <path
                fill="#EDEDED"
                opacity="1.000000"
                stroke="none"
                d="
M625.773071,478.608337 
	C614.950134,532.158997 604.340637,585.322449 593.642395,638.930664 
	C631.629456,638.930664 669.073914,638.930664 707.303589,638.930664 
	C706.050598,645.836792 704.883423,652.278198 703.711975,658.718933 
	C703.481445,659.986450 703.240540,661.252258 702.992676,662.516541 
	C702.543640,664.806702 701.659302,666.081360 698.812439,666.074402 
	C651.815918,665.959412 604.819153,665.979919 557.822388,665.958923 
	C557.680481,665.958862 557.538635,665.794800 556.629761,665.234558 
	C573.055359,582.073547 589.542236,498.602173 606.017700,415.188782 
	C616.942993,415.188782 627.400940,415.188782 638.128906,415.188782 
	C634.160339,434.712891 630.223938,454.000732 626.345825,473.300262 
	C626.024353,474.900024 626.097046,476.578979 625.773071,478.608337 
z"
              />
            </svg>
            <p
              style={{
                fontSize: 50,
                fontWeight: "bold",
                letterSpacing: "-0.025em",
                color: "white",
                padding: "0 120px",
                lineHeight: 1.4,
                whiteSpace: "pre-wrap",
                margin: 0,
              }}
            >
              {title}
            </p>
            <p
              style={{
                fontSize: 30,
                fontWeight: "normal",
                color: "#ededed",
                padding: "0 120px",
                lineHeight: 1.4,
                whiteSpace: "pre-wrap",
                margin: 0,
                textTransform: "capitalize",
              }}
            >
              {description}
            </p>
          </div>
        </div>
      ),
      {
        width: 1200,
        height: 630,
      }
    );
  } catch (e: any) {
    console.log(`${e.message}`);
    return new Response(`Failed to generate the image`, {
      status: 500,
    });
  }
}
